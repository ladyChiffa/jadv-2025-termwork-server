# Сервер чата

## Архитектура

1. Server
   - организует пул потоков для обработки;
   - открывает порт на ожидание подключений от клиентов;
   - при установлении соединения с клиентом начинает обрабатывать сообщения от этого клиента в одном потоке (каждый поток обрабатывает запросы одного клиента);
   - поток закрывается, когда клиент отправляет команду об окончании сессии.

2. ServerChat
   - экземпляр класса хранит все сообщения, попавшие в чат.

3. ClientChat
    - класс описывает подключение одного конкретного клиента и процесс обработки сообщений этого клиента;
    - каждый объект класса обрабатывается в собственном потоке;
    - у каждого подключения имеется идентификатор (идентификатор выдается по AtomicInteger счетчику);
    - авторизация пользователя отсутствует, пользователи не различаются - ClientChat это именно отдельное подключение.

## Протокол    

### Запрос

Запрос клиента - это одна текстовая строка. Запрос заканчивается переносом строки. 

Клиент может прислать 2 типа запросов:
- команда;
- сообщение.

Команда - это строка, которая начинается с / и далее идет имя команды. После команды через пробел 
может идти дополнительная информация, которая требуетя этой команде.

Пример

``/hello Оксана`` - представиться серверу, установить свое имя

``/poll`` - получить сообщения из чата, которые появились с предыдущего запроса "/poll" и не являются сообщениями текущего клиента.
   
``/exit`` - завершить работу и закрыть соединение

В результате выполнения команды сервер может помещать служебные сообщения в чат сервера.

Сообщение - это просто текстовая строка (любой текст, который не начинается с /). 
Сообщение подписывается идентификатором и именем клиента и отправляется в чат сервера с отметкой времени.

### Ответ

Сервер отвечает простым текстом в следующих случаях:
- при подключении клиента (отправляет привественное сообщение и информацию о доступных командах);
- при выполнении команды ``/poll`` (отправляет текст из чата).

